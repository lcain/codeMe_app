  var checkIfLoggedIn = function () {
    if (window.current_user) {
      console.log("User logged in");
    } else {
      console.log("No user");
    }
  };

var sanitizeText = function (text) {
  var re = new RegExp("<.*script.*>(.*<\s*\/\s*script\s*>)?", "g");
  var currentContent = $("#txt").val();

  var newContent = currentContent.replace( re, "" );
  $("#txt").val(newContent);

  return newContent;
};

$(document).ready(function(){

  //This is the editable HTML text box.
  $('#staticLink').on('click', function(){

      $('#hypertextDropdown.notDropped').toggleClass( "dropped" )
      
      $('#txt').toggleClass( "inv" );

  });

  //This is the editable HTML text box.
  // This renders the page on keyup.
  $('#txt').keyup(function(){

    $('#userPage').html(   sanitizeText($(this).val())    );

  })//.trigger("keyup"); //This makes what's in the editable HTML text box render on the page automatically on page load.

  // This is to allow tabbing in the text box.
  $(document).delegate('#txt', 'keydown', function(e) {
    var keyCode = e.keyCode || e.which;

    if (keyCode == 9) {
      e.preventDefault();
      var start = $(this).get(0).selectionStart;
      var end = $(this).get(0).selectionEnd;

      // set textarea value to: text before caret + tab + text after caret
      $(this).val($(this).val().substring(0, start)
                  + "\t"
                  + $(this).val().substring(end));

      // put caret at right position again
      $(this).get(0).selectionStart =
      $(this).get(0).selectionEnd = start + 1;
    }

  });


  // Automated intro starts here:
  // Check to see if the user is logged in. If logged in, no intro, if not logged in start the intro.
  var checkIfLoggedIn = function () {
    if (window.current_user) {
      // console.log("User logged in");
    } else {
      // console.log("No user");

      intro();
    }
  };

  // Check to see if the user is on the homepage.
  // Only start intro if the user is on the homepage.
  var homePage = function(){
    if(location.pathname === '/'){
      checkIfLoggedIn();
    }
  };

  homePage();

  tutorial();



// End of Document Ready
});




    // $.ajax('/styles/3.json').done(function(data){
    //   console.log(data);

    //   var json = CSSJSON.toJSON(data.content);
    //   var css = CSSJSON.toCSS(json);

    //   // console.log(css)
    //   $('.style').append('<style>' + css + '</style>')
    //   $('.style').append( css )

    //   // $('body').css(css)
    // })


  // $('.button').on('click', function(){
    
  //   $.ajax('/hypertexts/3.json').done(function(data){
  //     console.log(data);
  //     $('#userPage').append($(data.content))
  //   })

  // });
